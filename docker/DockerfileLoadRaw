# Use AWS Lambda Python 3.9 base image for x86_64 (not arm64)

# For production use, using the official AWS Lambda base image
FROM public.ecr.aws/lambda/python:3.9 AS base

# For local development, Use a base Python image
# FROM python:3.9-slim-buster

# Set working directory to /var/task (AWS Lambda default)
WORKDIR /var/task

# Copy application files into the container
COPY src/load_raw.py .
COPY docker/requirements-load-raw.txt .
RUN mkdir ./test
COPY ./test/load_raw_test.json ./test/load_raw_test.json

# Install dependencies
RUN pip install --upgrade pip
RUN pip install --no-cache-dir -r requirements-load-raw.txt

# For production use, Set the entry point and handler correctly
ENTRYPOINT ["/var/lang/bin/python3.9", "-m", "awslambdaric"]
CMD ["lambda_function.load_raw"]

# For local use, Set the ENTRYPOINT to execute the Python script
# ENTRYPOINT ["/var/lang/bin/python3.9", "load_raw.py"]